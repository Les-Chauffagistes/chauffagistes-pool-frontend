<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Pool Statistics – Chauffagistes</title>
    <link rel="icon" href="logo.jpg" type="image/jpeg"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <style>
      :root {
        --bg: #0d0d0d;
        --fg: #ffffff;
        --muted:#b9b9b9;
        --orange:#f7931a;
        --card:#131313;
        --border:#2a2a2a;
        --good:#1aa179;
        --bad:#c43c3c;
      }
      body { background-color: var(--bg); color: var(--fg); font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
      .section-title { color: var(--orange); border-bottom: 1px solid #f7931a44; padding-bottom:.5rem; margin-top:2rem; }
      .text-orange{color:var(--orange)}
      .kpi { background:var(--card); border:1px solid var(--border); border-radius:14px; padding:12px 14px; height:100%;}
      .kpi .label{color:var(--muted); font-size:.9rem}
      .kpi .value{font-weight:700; font-size:1.25rem}
      .card-dark{ background:var(--card); border:1px solid var(--border); border-radius:14px; }
      .pill{ display:inline-flex; gap:.35rem; align-items:center; padding:.25rem .6rem; border-radius:999px; border:1px solid var(--border); background:#161616; color:#eee; font-size:.85rem}
      .pill.good{ border-color: #17483b; background:#0f3228; color:#c6fff0}
      .pill.bad{ border-color: #4a1e1e; background:#341414; color:#ffc6c6}
      .btn, .form-control{ border-radius:10px}
      .table-dark { --bs-table-bg: #0f0f0f; --bs-table-striped-bg:#141414; --bs-table-border-color:#232323; }
      .muted{ color:var(--muted)}
      .tiny{ font-size:.85rem }
      .spark{ width:100%; height:6px; border-radius:999px; background:linear-gradient(90deg, #2b2b2b, #2b2b2b); position:relative; overflow:hidden}
      .spark .fill{ position:absolute; height:100%; left:0; top:0; background:var(--orange)}
      .loader{opacity:.6}
      .pointer{cursor:pointer}
      .chart-wrap{ padding:12px }
      .btn-range { border-color:#5c5c5c; color:#eaeaea }
      .btn-range.active, .btn-range:focus { background: var(--orange); border-color: var(--orange); color:#111; }

      /* Flags in language switcher */
      .lang-link { display:flex; align-items:center; gap:.5rem; }
      .lang-switcher .nav-link { padding:.25rem .6rem; border:1px solid var(--border); border-radius:999px; }
      .lang-switcher .nav-link.active { background:var(--orange); color:#111; border-color:var(--orange); }
    </style>
  </head>
  <body class="container py-4">
    <header class="d-flex justify-content-between align-items-center mb-3">
        <h1 class="text-orange h3 m-0">Chauffagistes Pool Statistics</h1>
        <div class="d-flex align-items-center gap-3">
            <!-- Back to home -->
            <a href="/en/" rel="home" class="btn btn-sm btn-outline-light" aria-label="Back to home">← Back to home</a>

            <!-- Language switcher -->
            <ul class="navbar-nav ms-lg-3 flex-row gap-2 lang-switcher">
            <li class="nav-item d-flex align-items-center">
                <a class="nav-link lang-link" href="/public-stats.html" lang="fr" hreflang="fr" aria-label="Français">
                <span class="flag" aria-hidden="true">
                    <svg viewBox="0 0 3 2" width="18" height="12" xmlns="http://www.w3.org/2000/svg">
                    <rect width="1" height="2" x="0" y="0" fill="#0055A4"/>
                    <rect width="1" height="2" x="1" y="0" fill="#fff"/>
                    <rect width="1" height="2" x="2" y="0" fill="#EF4135"/>
                    </svg>
                </span>
                FR
                </a>
            </li>
            <li class="nav-item d-flex align-items-center">
                <a class="nav-link lang-link active" href="/en/public-stats.html" lang="en" hreflang="en" aria-label="English">
                <span class="flag" aria-hidden="true">
                    <svg viewBox="0 0 60 30" width="18" height="9" xmlns="http://www.w3.org/2000/svg">
                    <clipPath id="s"><path d="M0,0 v30 h60 v-30 z"/></clipPath>
                    <clipPath id="t"><path d="M30,15 h30 v15 z v-30 z h-30 z h-30 z v30 z"/></clipPath>
                    <g clip-path="url(#s)">
                        <path d="M0,0 v30 h60 v-30 z" fill="#012169"/>
                        <path d="M0,0 L60,30 M60,0 L0,30" stroke="#fff" stroke-width="6"/>
                        <path d="M0,0 L60,30 M60,0 L0,30" clip-path="url(#t)" stroke="#C8102E" stroke-width="4"/>
                        <path d="M30,0 v30 M0,15 h60" stroke="#fff" stroke-width="10"/>
                        <path d="M30,0 v30 M0,15 h60" stroke="#C8102E" stroke-width="6"/>
                    </g>
                    </svg>
                </span>
                EN
                </a>
            </li>
            </ul>

            <span class="pill" id="freshnessPill" aria-live="polite">Updated: –</span>
            <button id="refreshBtn" class="btn btn-sm btn-outline-warning" aria-label="Refresh data">↻ Refresh</button>
        </div>
        </header>

    <!-- Runtime / headcount -->
    <section class="mb-3">
      <div class="row g-3">
        <div class="col-6 col-md-3">
          <div class="kpi">
            <div class="label">Uptime</div>
            <div class="value" id="uptime">–</div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="kpi">
            <div class="label">Last update</div>
            <div class="value" id="lastupdate">–</div>
          </div>
        </div>
        <div class="col-6 col-md-2">
          <div class="kpi">
            <div class="label">Users</div>
            <div class="value" id="users">–</div>
          </div>
        </div>
        <div class="col-6 col-md-2">
          <div class="kpi">
            <div class="label">Workers</div>
            <div class="value"><span id="workers">–</span> <span class="tiny muted">(active&nbsp;<span id="workersActive">–</span>)</span></div>
          </div>
        </div>
        <div class="col-6 col-md-2">
          <div class="kpi">
            <div class="label">Status</div>
            <div class="d-flex gap-2 mt-1">
              <span class="pill good">Idle <span id="idle">–</span></span>
              <span class="pill bad">Disconnected <span id="disco">–</span></span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Hashrates -->
    <section>
      <h2 class="section-title">Hashrate (Pool)</h2>
      <div class="row g-3">
        <div class="col-6 col-md-3"><div class="kpi"><div class="label">1 min</div><div class="value" id="hr1m">–</div></div></div>
        <div class="col-6 col-md-3"><div class="kpi"><div class="label">5 min</div><div class="value" id="hr5m">–</div></div></div>
        <div class="col-6 col-md-3"><div class="kpi"><div class="label">15 min</div><div class="value" id="hr15m">–</div></div></div>
        <div class="col-6 col-md-3"><div class="kpi"><div class="label">1 h</div><div class="value" id="hr1h">–</div><div class="spark mt-2"><div id="spark1h" class="fill" style="width:0%"></div></div></div></div>
        <div class="col-6 col-md-3"><div class="kpi"><div class="label">6 h</div><div class="value" id="hr6h">–</div></div></div>
        <div class="col-6 col-md-3"><div class="kpi"><div class="label">1 d</div><div class="value" id="hr1d">–</div></div></div>
        <div class="col-6 col-md-3"><div class="kpi"><div class="label">7 d</div><div class="value" id="hr7d">–</div></div></div>
      </div>
    </section>

    <!-- User lookup -->
    <section>
      <h2 class="section-title">Find a user</h2>
      <div class="row g-2 align-items-center">
        <div class="col-md-6">
          <input type="text" id="btcInput" class="form-control" placeholder="Enter a BTC address" aria-label="Bitcoin address"/>
        </div>
        <div class="col-6 col-md-auto d-flex gap-2">
          <button id="btnSearch" class="btn btn-warning">View my stats</button>
          <button id="btnCopy" class="btn btn-outline-light" title="Copy address">Copy</button>
        </div>
        <div class="col-6 col-md-auto form-check ms-2">
          <input class="form-check-input" type="checkbox" id="hideZero" checked>
          <label class="form-check-label" for="hideZero">Hide zero-hash workers</label>
        </div>
      </div>
      <div id="userStats" class="mt-4"></div>
    </section>

    <!-- Shares -->
    <section>
      <h2 class="section-title">Shares & Quality</h2>
      <div class="row g-3">
        <div class="col-md-6">
          <div class="card-dark p-3 h-100">
            <ul class="m-0">
              <li>Accepted: <strong id="sharesAccepted">–</strong></li>
              <li>Rejected: <strong id="sharesRejected">–</strong></li>
              <li>Rejection rate: <strong id="rejectRate">–</strong></li>
              <li>Best share: <strong id="bestShare">–</strong></li>
              <li>Current diff: <strong id="diff">–</strong></li>
            </ul>
          </div>
        </div>
        <div class="col-md-6">
          <div class="card-dark p-3 h-100">
            <div class="mb-2">Shares / sec (SPS)</div>
            <div class="d-flex flex-wrap gap-2">
              <span class="pill">1m: <span id="sps1m">–</span></span>
              <span class="pill">5m: <span id="sps5m">–</span></span>
              <span class="pill">15m: <span id="sps15m">–</span></span>
              <span class="pill">1h: <span id="sps1h">–</span></span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Leaderboards -->
    <section>
      <h2 class="section-title">Leaderboards</h2>
      <div class="row g-3">
        <div class="col-lg-6">
          <div class="card-dark p-3">
            <h5 class="text-orange mb-2">Top Hashrate (1h)</h5>
            <ul id="topHashrate" class="list-unstyled m-0"></ul>
          </div>
        </div>
        <div class="col-lg-6">
          <div class="card-dark p-3">
            <h5 class="text-orange mb-2">Top Best Shares</h5>
            <ul id="topBestShares" class="list-unstyled m-0"></ul>
          </div>
        </div>
      </div>
    </section>

    <!-- History -->
    <section>
      <h2 class="section-title d-flex align-items-center justify-content-between">
        <span>Hashrate History</span>
        <div class="btn-group" role="group" aria-label="History range">
          <button type="button" class="btn btn-sm btn-outline-light btn-range" data-range="7d">Week</button>
          <button type="button" class="btn btn-sm btn-outline-light btn-range active" data-range="30d">Month</button>
          <button type="button" class="btn btn-sm btn-outline-light btn-range" data-range="365d">Year</button>
          <button type="button" class="btn btn-sm btn-outline-light btn-range" data-range="all">All time</button>
        </div>
      </h2>
      <div class="card-dark p-3">
        <canvas id="hashrateChart" style="max-height:300px;"></canvas>
        <div class="tiny muted mt-2">Unit: TH/s (daily averages)</div>
      </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="../stats-pool.js"></script>
  </body>
</html>
